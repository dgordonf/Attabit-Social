<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  
  <script type='text/javascript' src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <script src="https://kit.fontawesome.com/e0661229f6.js" crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Monda&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel='shortcut icon' href='favicon.png' type='image/x-icon'/ >
  <link rel="apple-touch-icon" href="favicon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="manifest" href="manifest.json" />
  <title>Attabit</title>
</head>
<body>

    <div id = "feed_inner">
    {% if posts|length == 0 %}
    <div style="font-size:20px;font-weight:600;margin-top:20px;" class = "post_box border border-0">
      <div class = "post_inner">
      Anyone out there? Posts from people you follow will appear here. 
      <br>
      <br>
      See the <a href = "/search" style = "text-decoration: underline;" >leaderboard</a> to find people to follow.
      </div>
    </div>

    {% else %}
    {% endif %}

     {% for index, posts in posts.iterrows() %}
    
      <div class = "post_wrap">
      <div id = post_{{index}} class="post_box border border-0">

        <div id= "post_inner_{{index}}" class = "post_inner">

        {% if posts['user_id'] == current_user_id %}
        <form id="post_delete" class= "post_delete" title="" action= "/post_delete/{{posts['post_id']}}" method= "post" >
          <input class= hidden id = "update_type" name= "update_type" value = "post_delete">  
          <button class = "delete_button" type="submit">
            <i class="far fa-times-circle"></i>
          </button>  
        
        </form>
        {% else %}  
        {% endif %}  
   
        <div class = "post_info_box" onclick="window.location='/post/{{posts['post_id']}}'" style="cursor: pointer;" tabindex="1">
            <a class= "profile_link" href = "/@{{posts['handle']}}">
              <div class = "badge" style = "background-image:url('https://hideawayy.s3.amazonaws.com/media/{{ posts['profile_photo'] }} ');">
                
              </div>
            </a>  
            
            <div class = "handle_score_box">
              <div style= 'height: 18px;'>
                <a class= "profile_link" href = "/@{{posts['handle']}}">
                <span class= "handle"><span style="font-size:14px;margin-right:1px;"></span>{{posts['handle']}}</span>
                </a>  
                <span class="level_details">lvl {{posts['user_score']}}</span><span class="time_details">{{posts['time_ago']}}</span>



              </div>

                <div class = "post_text">
                  <span  style="white-space: pre-wrap;" >{{ posts['post_text']|urlize(30, true)|emojify|safe }}</span> 
                </div>
            </div>
        </div>
    
        {% if posts['post_length_flag'] == 1 %}
        <div style="padding-bottom:5px;margin-bottom: 10px; font-weight:600; opacity: .40; text-align:center;">
          ------------- more -------------
        </div>
        {% endif %}

          <div class = "post_icons">
            
              <div style= "width:30%">  
                <a class="post_link" href = "/post/{{posts['post_id']}}">    
                <button class = "reply_button" id = "reply_button_{{posts['post_id']}}" value = '{{posts['post_id']}}'>
                  <span class = "_8bit_button" style="font-size:15px; opacity:.69; margin-left:7px"><i style="font-size: 17px;" class="far fa-comment"></i> {{posts['reply_count']}}</span>
                </button>  
                </a>  
              </div>
            
              <div style= "width:30%">
                <form id="{{index}}" title="" action= "/quickvote" method= "post" class= "form_arrows">
                  
                  <input type="hidden" id = "post_id" name= "post_id" value={{posts['post_id']}} >
                  {% if posts['current_user_vote'] <= -1 %}
                  
                  <input id = "down_vote_value_{{index}}" class= hidden name= "post_vote" value = 0>
                  <button id= "down_submit_{{index}}"  type="submit" class="arrow_button">
                    <span id = "down_vote_wrapper_{{index}}" style="margin-left:22px" class = "pre_vote voted_button"><i style="font-size: 17px;" class="fas fa-caret-down"></i> <span class = "_8bit_button" id="down_vote_text_{{index}}">{{posts['down_votes']}}</span></span>
                  </button>  
                    {% else %}
                  
                  <input id = "down_vote_value_{{index}}" class= hidden name= "post_vote" value = -1>  
                  <button id= "down_submit_{{index}}" type="submit" class="arrow_button">
                    <span id = "down_vote_wrapper_{{index}}" style="margin-left:22px" class = "pre_vote"><i style="font-size: 17px;" class="fas fa-caret-down"></i> <span class = "_8bit_button" id="down_vote_text_{{index}}">{{posts['down_votes']}}</span></span>
                  </button>  
                    {% endif %} 
                  
                </form>
              </div>

              <div style= "width:30%">
                <form id="{{index}}" title="" action="/quickvote" method="post" class = "form_arrows">
                  
                  <input type="hidden" name= "post_id" value={{posts['post_id']}} >
                  {% if posts['current_user_vote'] >= 1 %}
                  
                  <input id = "up_vote_value_{{index}}" class= hidden name= "post_vote" value = 0>
                  <button id= "up_submit_{{index}}"  type="submit" class="arrow_button">
                    <span id = "up_vote_wrapper_{{index}}" style="margin-left:22px" class = "pre_vote voted_button"><i style="font-size: 17px;" class="fas fa-caret-up"></i> <span class = "_8bit_button" id="up_vote_text_{{index}}">{{posts['up_votes']}}</span></span>
                  </button>  
                    {% else %}

                  <input id = "up_vote_value_{{index}}" class= hidden name= "post_vote" value = 1>  
                  <button id= "up_submit_{{index}}" type="submit" class="arrow_button">
                    <span id = "up_vote_wrapper_{{index}}" style="margin-left:22px" class = "pre_vote"><i style="font-size: 17px;" class="fas fa-caret-up"></i> <span class = "_8bit_button" id="up_vote_text_{{index}}">{{posts['up_votes']}}</span></span>
                  </button>  
                    {% endif %} 
                  </button>
                </form>
              </div>
          </div>
        </div>  
      </div>
  </div>


    {% endfor %}
  </div>

{% endblock %}    
</div>

</body>
</html>